{
  "test_execution": {
    "timestamp": "2025-10-31T13:37:18.017692",
    "test_suite_version": "1.0.0",
    "environment": "validation"
  },
  "sample_export": {
    "schedule_id": "SCH_20240115_TESTCREATOR",
    "page_name": "test_creator",
    "export_method": "apps_script",
    "status": "success",
    "messages_exported": 42,
    "duration_seconds": 2.34,
    "sheet_name": "test_creator",
    "exported_at": "2024-01-15T08:30:45Z",
    "columns_exported": [
      "schedule_id",
      "page_name",
      "day_of_week",
      "scheduled_send_time",
      "message_type",
      "caption_id",
      "caption_text",
      "price_tier",
      "content_category",
      "has_urgency",
      "performance_score"
    ],
    "sample_rows": [
      {
        "schedule_id": "SCH_20240115_TESTCREATOR",
        "page_name": "test_creator",
        "day_of_week": "Monday",
        "scheduled_send_time": "2024-01-15 09:00:00",
        "message_type": "ppv",
        "caption_id": 12345,
        "caption_text": "Check out this amazing new content...",
        "price_tier": "premium",
        "content_category": "teaser",
        "has_urgency": true,
        "performance_score": 0.1523
      },
      {
        "schedule_id": "SCH_20240115_TESTCREATOR",
        "page_name": "test_creator",
        "day_of_week": "Monday",
        "scheduled_send_time": "2024-01-15 15:00:00",
        "message_type": "text",
        "caption_id": null,
        "caption_text": null,
        "price_tier": null,
        "content_category": null,
        "has_urgency": false,
        "performance_score": null
      },
      {
        "schedule_id": "SCH_20240115_TESTCREATOR",
        "page_name": "test_creator",
        "day_of_week": "Monday",
        "scheduled_send_time": "2024-01-15 21:00:00",
        "message_type": "ppv",
        "caption_id": 12346,
        "caption_text": "New exclusive content just for you!",
        "price_tier": "vip",
        "content_category": "explicit",
        "has_urgency": true,
        "performance_score": 0.1876
      }
    ],
    "formatting_applied": {
      "header_row_frozen": true,
      "header_bold": true,
      "header_background": "#4285f4",
      "alternating_row_colors": true,
      "auto_resized_columns": true,
      "performance_score_format": "percentage",
      "datetime_format": "YYYY-MM-DD HH:MM:SS"
    }
  },
  "duplicate_prevention": {
    "schedule_id": "SCH_20240115_TESTCREATOR",
    "duplicate_check_performed": true,
    "duplicate_window_hours": 24,
    "is_duplicate": false,
    "message": "No recent export found, proceeding with export"
  },
  "logging": {
    "log_table": "schedule_export_log",
    "log_entry_created": true,
    "log_fields": {
      "schedule_id": "SCH_20240115_TESTCREATOR",
      "export_status": "success",
      "record_count": 42,
      "duration_seconds": 2.34,
      "sheet_name": "test_creator",
      "error_message": null,
      "exported_at": "2024-01-15T08:30:45Z"
    }
  },
  "validation_checks": {
    "bigquery_view_accessible": true,
    "schedule_exists": true,
    "data_retrieved": true,
    "sheet_created": true,
    "headers_written": true,
    "data_written": true,
    "formatting_applied": true,
    "log_entry_created": true
  }
}